{"version":3,"sources":["src/server/bridges/CloudWorkspaceBridge.ts"],"names":[],"mappings":";;;AAAA,6CAA0C;AAE1C,2EAAwE;AACxE,kEAA+D;AAE/D,2EAAwE;AAIxE,MAAsB,oBAAqB,SAAQ,uBAAU;IAClD,mBAAmB,CAAC,KAAa,EAAE,KAAa;QACnD,IAAI,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,EAAE;YACrC,OAAO,IAAI,CAAC,iBAAiB,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC;SAC/C;IACL,CAAC;IAIO,uBAAuB,CAAC,KAAa;QACzC,IAAI,2CAAoB,CAAC,aAAa,CAAC,KAAK,EAAE,+BAAc,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,EAAE;YACpF,OAAO,IAAI,CAAC;SACf;QAED,2CAAoB,CAAC,gBAAgB,CAAC,IAAI,6CAAqB,CAAC;YAC5D,KAAK;YACL,kBAAkB,EAAE,CAAC,+BAAc,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC;SAChE,CAAC,CAAC,CAAC;QAEJ,OAAO,KAAK,CAAC;IACjB,CAAC;CACJ;AArBD,oDAqBC","file":"CloudWorkspaceBridge.js","sourcesContent":["import { BaseBridge } from './BaseBridge';\n\nimport { AppPermissionManager } from '../managers/AppPermissionManager';\nimport { AppPermissions } from '../permissions/AppPermissions';\n\nimport { PermissionDeniedError } from '../errors/PermissionDeniedError';\n\nimport { IWorkspaceToken } from '../../definition/cloud/IWorkspaceToken';\n\nexport abstract class CloudWorkspaceBridge extends BaseBridge {\n    public doGetWorkspaceToken(scope: string, appId: string): Promise<IWorkspaceToken> {\n        if (this.hasCloudTokenPermission(appId)) {\n            return this.getWorkspaceToken(scope, appId);\n        }\n    }\n\n    protected abstract getWorkspaceToken(scope: string, appId: string): Promise<IWorkspaceToken>;\n\n    private hasCloudTokenPermission(appId: string): boolean {\n        if (AppPermissionManager.hasPermission(appId, AppPermissions.cloud['workspace-token'])) {\n            return true;\n        }\n\n        AppPermissionManager.notifyAboutError(new PermissionDeniedError({\n            appId,\n            missingPermissions: [AppPermissions.cloud['workspace-token']],\n        }));\n\n        return false;\n    }\n}\n"]}